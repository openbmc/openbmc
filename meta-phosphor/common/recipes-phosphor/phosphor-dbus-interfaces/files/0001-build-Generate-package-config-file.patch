From 345bef7533e26ce907c7e6024524496d47fa53a4 Mon Sep 17 00:00:00 2001
From: Patrick Williams <patrick@stwcx.xyz>
Date: Mon, 30 Jan 2017 10:21:52 -0600
Subject: [PATCH] build: Generate package-config file

Change-Id: Ib776dad5936f1542fd2855a67954f2959c23ef45
Signed-off-by: Patrick Williams <patrick@stwcx.xyz>
---
 Makefile.am                    |  3 +++
 configure.ac                   |  1 +
 phosphor-dbus-interfaces.pc.in | 11 +++++++++++
 3 files changed, 15 insertions(+)
 create mode 100644 phosphor-dbus-interfaces.pc.in

diff --git a/Makefile.am b/Makefile.am
index 7ac8318..354cfc9 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -10,6 +10,9 @@ libphosphor_dbus_la_CXXFLAGS = $(SYSTEMD_CFLAGS)
 BUILT_SOURCES = libphosphor_dbus.cpp
 CLEANFILES = libphosphor_dbus.cpp
 
+pkgconfiglibdir = ${libdir}/pkgconfig
+pkgconfiglib_DATA = phosphor-dbus-interfaces.pc
+
 clean-local: clean-dbus
 
 -include Makefile.interfaces
diff --git a/configure.ac b/configure.ac
index 770637c..b4bcc07 100644
--- a/configure.ac
+++ b/configure.ac
@@ -41,4 +41,5 @@ LT_LIB_DLLOAD
 AC_CONFIG_FILES([Makefile.interfaces],
     [${srcdir}/generate_makefile.sh ${srcdir} > Makefile.interfaces])
 AC_CONFIG_FILES([Makefile])
+AC_CONFIG_FILES([phosphor-dbus-interfaces.pc])
 AC_OUTPUT
diff --git a/phosphor-dbus-interfaces.pc.in b/phosphor-dbus-interfaces.pc.in
new file mode 100644
index 0000000..3240872
--- /dev/null
+++ b/phosphor-dbus-interfaces.pc.in
@@ -0,0 +1,11 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+
+Name: phosphor-dbus-interfaces
+Description: Generated sdbusplus bindings for phosphor-dbus-interfaces.
+URL: https://github.com/openbmc/phosphor-dbus-interfaces
+Version: @VERSION@
+Libs: -L@libdir@ -lphosphor_dbus
+Cflags: -I@includedir@
-- 
2.10.2

