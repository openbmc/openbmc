KERNEL_DEVICETREE = "axiado/axiado-evk-mt2.dtb"
KERNEL_DEVICETREE += "axiado/axiado-evk-sb2.dtb"
KERNEL_DEVICETREE += "axiado/ax3080a1s_hv2.dtb"

SOC_REVISION = "revA"

# Conditional assignments for different board revisions
UBOOT_MACHINE_revA = "ax3000_evk_defconfig"
UBOOT_MACHINE_revB = "ax3000b0_evk_defconfig"

# Dynamically set KBUILD_DEFCONFIG based on SOC_REVISION
UBOOT_MACHINE = "${UBOOT_MACHINE_${SOC_REVISION}}"

# Fallback to default if SOC_REVISION is not set or doesn't match
UBOOT_MACHINE ??= "ax3000_evk_defconfig"

require conf/machine/include/axiado.inc
require conf/machine/include/obmc-evb-common.inc

FLASH_SIZE = "65535"
SERIAL_CONSOLES = "115200;ttyPS3"

OBMC_COMPATIBLE_NAMES = "ax3000"
EXTENDED_VERSION = "${DISTRO_VERSION}"

# Install Kernel modules
MACHINE_EXTRA_RRECOMMENDS = "kernel-modules"

IMAGE_FEATURES:remove = " \
    obmc-chassis-mgmt \
    obmc-chassis-state-mgmt \
    obmc-fan-control \
    obmc-fan-mgmt \
    obmc-host-ipmi \
    obmc-host-state-mgmt \
    obmc-ikvm \
"

VIRTUAL-RUNTIME_obmc-inventory-manager = "entity-manager"
VIRTUAL-RUNTIME_obmc-sensors-hwmon = "dbus-sensors"

# Fix sysproxy build error
DEBUG_PREFIX_MAP:remove = "-fcanon-prefix-map"
